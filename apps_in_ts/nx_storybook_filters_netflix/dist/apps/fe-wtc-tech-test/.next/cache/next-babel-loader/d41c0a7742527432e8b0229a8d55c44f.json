{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useEffect, useState } from 'react';\nimport styled from 'styled-components'; //custom\n\nimport Card from './Card/Card';\nimport generalAPIService from './services/apiService';\nconst Movies = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nconst Home = () => {\n  const {\n    0: movies,\n    1: getMovies\n  } = useState([]);\n\n  const calculateAvarageRatings = Ratings => {\n    const overAllPerc = Ratings.map(({\n      Value\n    }) => Value).reduce((avaragePerc, rating, index) => {\n      const percentageValue = [];\n      console.log('rating.....', rating);\n\n      if (rating.includes('/')) {\n        const [all, ratio] = rating.split('/').map(value => Number(value));\n        console.log([all, ratio]);\n        console.log('[all, ratio]', all / ratio);\n        const calcPercentage = all / ratio;\n        percentageValue.push(calcPercentage);\n      }\n\n      if (rating.includes('%')) {\n        const value = rating.match(/\\d+/)[0];\n        const percentage = Number(value);\n        console.log('percentage', percentage);\n        percentageValue.push(percentage);\n      }\n\n      console.log('percentageValueppppp.....', percentageValue);\n\n      if (index === Ratings.length - 1) {\n        const sumPercentage = percentageValue.reduce((acc, value) => acc + value);\n        console.log('percentageValue', percentageValue);\n        console.log('avaragePerc', sumPercentage);\n        avaragePerc = sumPercentage / Ratings.length;\n        return avaragePerc;\n      }\n    }, 0);\n    return overAllPerc;\n  };\n\n  const reduceData = response => {\n    return response.map(({\n      Title,\n      Poster,\n      Ratings\n    }) => {\n      const averageRatings = calculateAvarageRatings([{\n        Source: 'Internet Movie Database',\n        Value: '8.1/10'\n      }, {\n        Source: 'Rotten Tomatoes',\n        Value: '85%'\n      }, {\n        Source: 'Metacritic',\n        Value: '69/100'\n      }]);\n      console.log('averageRatings', averageRatings);\n      return {\n        Title,\n        Poster,\n        averageRatings\n      };\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const result = await generalAPIService.get('/api/movies');\n      console.log('result', result);\n      getMovies(reduceData(result));\n    };\n\n    fetchData();\n  }, []);\n  return __jsx(\"main\", null, __jsx(Movies, null, movies.map(fields => __jsx(Card, _extends({}, fields, {\n    key: fields.Title\n  })))));\n};\n\nexport default Home;","map":{"version":3,"sources":["/Users/gilg/dev/job_tests/fe-tech-test-greg-gil/apps/fe-wtc-tech-test/pages/index.tsx"],"names":["Movies","styled","div","Home","getMovies","useState","calculateAvarageRatings","Ratings","overAllPerc","Value","percentageValue","console","rating","value","Number","all","calcPercentage","percentage","index","sumPercentage","acc","avaragePerc","reduceData","response","averageRatings","Source","useEffect","fetchData","result","generalAPIService","fields","Title"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\n//custom\nimport Card from './Card/Card';\nimport generalAPIService from './services/apiService';\n\nconst Movies = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nconst Home = () => {\n  const [movies, getMovies] = useState([]);\n\n  interface ImoviesResponseFields {\n    Title: string;\n    Poster: string;\n    Ratings: {}[];\n    key: string;\n  }\n  const calculateAvarageRatings = (Ratings: {}[]) => {\n    const overAllPerc = Ratings.map(\n      ({ Value }: { Value: string }) => Value\n    ).reduce((avaragePerc, rating, index) => {\n      const percentageValue: number[] = [];\n\n      console.log('rating.....', rating);\n\n      if (rating.includes('/')) {\n        const [all, ratio] = rating.split('/').map((value) => Number(value));\n        console.log([all, ratio]);\n        console.log('[all, ratio]', all / ratio);\n        const calcPercentage = all / ratio;\n        percentageValue.push(calcPercentage);\n      }\n\n      if (rating.includes('%')) {\n        const value = rating.match(/\\d+/)[0];\n        const percentage = Number(value);\n        console.log('percentage', percentage);\n        percentageValue.push(percentage);\n      }\n\n      console.log('percentageValueppppp.....', percentageValue);\n      if (index === Ratings.length - 1) {\n        const sumPercentage = percentageValue.reduce(\n          (acc, value) => acc + value\n        );\n        console.log('percentageValue', percentageValue);\n        console.log('avaragePerc', sumPercentage);\n        avaragePerc = sumPercentage / Ratings.length;\n        return avaragePerc;\n      }\n    }, 0);\n\n    return overAllPerc;\n  };\n  const reduceData = (response: {}[]) => {\n    return response.map(({ Title, Poster, Ratings }: ImoviesResponseFields) => {\n      const averageRatings = calculateAvarageRatings([\n        { Source: 'Internet Movie Database', Value: '8.1/10' },\n        { Source: 'Rotten Tomatoes', Value: '85%' },\n        { Source: 'Metacritic', Value: '69/100' },\n      ]);\n\n      console.log('averageRatings', averageRatings);\n\n      return { Title, Poster, averageRatings };\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const result = await generalAPIService.get('/api/movies');\n      console.log('result', result);\n      getMovies(reduceData(result));\n    };\n\n    fetchData();\n  }, []);\n\n  return (\n    <main>\n      <Movies>\n        {movies.map((fields) => (\n          <Card {...fields} key={fields.Title} />\n        ))}\n      </Movies>\n    </main>\n  );\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}